
------------------------------------
Keras version      : 2.2.4-tf
TensorFlow version : 1.15.2
Python version     : 3.6.13 | packaged by conda-forge | (default, Sep 23 2021, 07:56:31) 
[GCC 9.4.0]
------------------------------------
Command line options:
 --input_height    :  28
 --input_width     :  28
 --input_chan      :  1
 --epochs          :  10
 --batchsize       :  100
 --learnrate       :  0.0001
 --output_ckpt_path:  ./build/chkpts/float_model.ckpt
 --infer_graph_path:  ./build/chkpts/inference_graph.pb
 --tboard_path     :  ./build/tb_logs
 --gpu             :  0
------------------------------------

Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
    8192/11490434 [..............................] - ETA: 0s   73728/11490434 [..............................] - ETA: 8s  319488/11490434 [..............................] - ETA: 3s  368640/11490434 [..............................] - ETA: 5s  655360/11490434 [>.............................] - ETA: 3s  884736/11490434 [=>............................] - ETA: 4s 1196032/11490434 [==>...........................] - ETA: 3s 1236992/11490434 [==>...........................] - ETA: 3s 1359872/11490434 [==>...........................] - ETA: 3s 1605632/11490434 [===>..........................] - ETA: 3s 1736704/11490434 [===>..........................] - ETA: 3s 1753088/11490434 [===>..........................] - ETA: 3s 2064384/11490434 [====>.........................] - ETA: 3s 2129920/11490434 [====>.........................] - ETA: 3s 2408448/11490434 [=====>........................] - ETA: 3s 2580480/11490434 [=====>........................] - ETA: 3s 2727936/11490434 [======>.......................] - ETA: 3s 3055616/11490434 [======>.......................] - ETA: 3s 3481600/11490434 [========>.....................] - ETA: 2s 3530752/11490434 [========>.....................] - ETA: 2s 3710976/11490434 [========>.....................] - ETA: 2s 4169728/11490434 [=========>....................] - ETA: 2s 4251648/11490434 [==========>...................] - ETA: 2s 4530176/11490434 [==========>...................] - ETA: 2s 4644864/11490434 [===========>..................] - ETA: 2s 5029888/11490434 [============>.................] - ETA: 2s 5226496/11490434 [============>.................] - ETA: 2s 5373952/11490434 [=============>................] - ETA: 2s 5586944/11490434 [=============>................] - ETA: 2s 5734400/11490434 [=============>................] - ETA: 1s 5832704/11490434 [==============>...............] - ETA: 2s 6062080/11490434 [==============>...............] - ETA: 1s 6225920/11490434 [===============>..............] - ETA: 1s 6406144/11490434 [===============>..............] - ETA: 1s 6586368/11490434 [================>.............] - ETA: 1s 6782976/11490434 [================>.............] - ETA: 1s 6995968/11490434 [=================>............] - ETA: 1s 7127040/11490434 [=================>............] - ETA: 1s 7266304/11490434 [=================>............] - ETA: 1s 7462912/11490434 [==================>...........] - ETA: 1s 7544832/11490434 [==================>...........] - ETA: 1s 7921664/11490434 [===================>..........] - ETA: 1s 8118272/11490434 [====================>.........] - ETA: 1s 8314880/11490434 [====================>.........] - ETA: 1s 8544256/11490434 [=====================>........] - ETA: 0s 8757248/11490434 [=====================>........] - ETA: 0s 8986624/11490434 [======================>.......] - ETA: 0s 9175040/11490434 [======================>.......] - ETA: 0s 9379840/11490434 [=======================>......] - ETA: 0s 9617408/11490434 [========================>.....] - ETA: 0s 9732096/11490434 [========================>.....] - ETA: 0s10092544/11490434 [=========================>....] - ETA: 0s10289152/11490434 [=========================>....] - ETA: 0s10469376/11490434 [==========================>...] - ETA: 0s10747904/11490434 [===========================>..] - ETA: 0s10797056/11490434 [===========================>..] - ETA: 0s11206656/11490434 [============================>.] - ETA: 0s11493376/11490434 [==============================] - 4s 0us/step
Network input shape:  (?, 28, 28, 1)
WARNING:tensorflow:From /workspace/customcnn.py:42: conv2d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.keras.layers.Conv2D` instead.
WARNING:tensorflow:From /opt/vitis_ai/conda/envs/vitis-ai-tensorflow/lib/python3.6/site-packages/tensorflow_core/python/layers/convolutional.py:424: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From /workspace/customcnn.py:43: batch_normalization (from tensorflow.python.layers.normalization) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.BatchNormalization instead.  In particular, `tf.control_dependencies(tf.GraphKeys.UPDATE_OPS)` should not be used (consult the `tf.keras.layers.batch_normalization` documentation).
                      (?, 14, 14, 16)
                      (?, 7, 7, 32)
                      (?, 4, 4, 64)
                      (?, 1, 1, 10)
WARNING:tensorflow:From /workspace/customcnn.py:63: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
Network output shape: (?, 10)
WARNING:tensorflow:From /opt/vitis_ai/conda/envs/vitis-ai-tensorflow/lib/python3.6/site-packages/tensorflow_core/python/ops/losses/losses_impl.py:121: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where

----------------------------
 TRAINING STARTED...
----------------------------
 Epoch 1 / 10 - accuracy 90.58 %
 Epoch 2 / 10 - accuracy 94.36 %
 Epoch 3 / 10 - accuracy 95.82 %
 Epoch 4 / 10 - accuracy 96.38 %
 Epoch 5 / 10 - accuracy 96.62 %
 Epoch 6 / 10 - accuracy 96.96 %
 Epoch 7 / 10 - accuracy 97.28 %
 Epoch 8 / 10 - accuracy 97.46 %
 Epoch 9 / 10 - accuracy 97.76 %
 Epoch 10 / 10 - accuracy 97.90 %

----------------------------
 SAVING CHECKPOINT & GRAPH...
----------------------------
 Saved checkpoint to ./build/chkpts/float_model.ckpt
Network input shape:  (?, 28, 28, 1)
                      (?, 14, 14, 16)
                      (?, 7, 7, 32)
                      (?, 4, 4, 64)
                      (?, 1, 1, 10)
Network output shape: (?, 10)
 Saved binary inference graph to ./build/chkpts/inference_graph.pb
 Run `tensorboard --logdir=./build/tb_logs --port 6006 --host localhost` to see the results.
